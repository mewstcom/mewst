<%= form_with(
  model: form,
  url: post_list_path,
  data: {
    character_counter_max_value: Post::MAXIMUM_CONTENT_LENGTH,
    controller: "character-counter url-detector",
    action: "turbo:submit-end->modal#close",
    url_detector_new_link_path_value: new_link_path
  }
) do |f| %>
  <%= render Cards::FormErrorsCardComponent.new(errors: f.object.errors) %>

  <label class="form-control pb-8">
    <div class="label pt-0">
      <span class="font-bold label-text">
        <%= t("messages.whats_happening") %>
      </span>
    </div>

    <%= f.hidden_field :with_frame %>

    <div class="leading-none p-0 textarea textarea-bordered w-full">
      <%= f.text_area(
        :content,
        autofocus: true,
        class: "bg-transparent focus:outline-none leading-loose px-4 py-2 w-full",
        data: {
          action: "character-counter#updateCounter url-detector#detectUrl",
          character_counter_target: "textarea",
          controller: "autosize",
          url_detector_target: "textarea",
        },
        rows: 1,
        tabindex: textarea_tabindex
      ) %>

      <div class="px-4 py-2">
        <turbo-frame
          data-url-detector-target="linkFormFrame"
          id="link-form"
        ></turbo-frame>

        <div class="text-right">
          <span
            class="text-gray-500 text-sm"
            data-character-counter-target="counter"
          ></span>
        </div>
      </div>
    </div>

    <div class="mt-2 text-center">
      <%= f.button class: "btn btn-primary no-animation rounded-full", tabindex: submit_button_tabindex, type: :submit do %>
        <i class="bi bi-send me-1"></i>
        <%= t("verbs.post") %>
      <% end %>
    </div>
  </label>
<% end %>
