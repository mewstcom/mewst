ARG RUBY_VERSION="3.2.2"
ARG BUNDLER_VERSION="2.4.10"

FROM \
    # SorbetがARM64に対応していなかったりするので、AMD64でビルドする
    # https://github.com/sorbet/sorbet/issues/4119
    --platform=linux/amd64 \
    amd64/ruby:${RUBY_VERSION}-slim-bookworm

RUN \
  apt update && \
  apt dist-upgrade -yq && \
  apt install -y --no-install-recommends \
    build-essential \
    curl \
    postgresql-client \
    libpq-dev && \
  gem install bundler -v "${BUNDLER_VERSION}"

WORKDIR /app

CMD ["bash"]
