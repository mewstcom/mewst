<%= render Navbars::NavbarComponent.new %>

<div class="container py-3 u-flat u-narrow">
  <%= render Navs::SettingsNavComponent.new %>

  <div class="mt-3">
    <h1 class="fw-bold">
      <%= t("nouns.connected_accounts") %>
    </h1>

    <div class="card mt-3">
      <div class="card-header">
        <div class="align-items-center gx-3 row">
          <div class="col-auto">
            <i class="bi bi-twitter fs-3 text-twitter"></i>
          </div>

          <div class="col">
            Twitter
          </div>
        </div>
      </div>

      <div class="card-body">
        <div>
          <% if @twitter_account.present? %>
            <i class="bi bi-check-circle-fill text-success-emphasis"></i>

            <span class="ms-1">
              <%= t("messages.connected_accounts.connected") %>
            </span>

            <span class="ms-1">
              (<%= link_to "@#{@twitter_account.username}", @twitter_account.profile_url, target: "_blank", rel: "nofollow" %>)
            </span>

            <% if @twitter_account.can_cross_post? || @twitter_account.can_find_friends? %>
              <ul class="mt-3">
                <% if @twitter_account.can_cross_post? %>
                  <li>
                    <%= t("activemodel.attributes.twitter_authorization.cross_post_usage") %>
                  </li>
                <% end %>

                <% if @twitter_account.can_find_friends? %>
                  <li>
                    <%= t("activemodel.attributes.twitter_authorization.find_friends_usage") %>
                  </li>
                <% end %>
              </ul>
            <% end %>
          <% else %>
            <i class="bi bi-info-circle-fill text-info-emphasis"></i>

            <span class="ms-1">
              <%= t("messages.connected_accounts.not_connected") %>
            </span>
          <% end %>
        </div>

        <div class="mt-3">
          <% if current_profile!.twitter_account.present? %>
            <div class="text-center">
              <%= button_to t("verbs.disconnect"), settings_twitter_account_path, {
                class: "btn btn-link",
                data: {
                  confirm: t("messages.connected_accounts.are_you_sure"),
                  disable_with: t("messages.connected_accounts.disconnecting")
                },
                method: :delete
              } %>
            </div>
          <% else %>
            <%= form_with data: { turbo: false }, model: @twitter_auth, url: settings_twitter_authorization_path do |f| %>
              <label class="form-label">
                <%= t("messages.twitter_authorization.usages") %>
              </label>

              <div class="form-check">
                <%= f.check_box :cross_post_usage, class: "form-check-input" %>
                <%= f.label :cross_post_usage, class: "form-check-label" %>
              </div>

              <div class="form-check">
                <%= f.check_box :find_friends_usage, class: "form-check-input" %>
                <%= f.label :find_friends_usage, class: "form-check-label" %>
              </div>

              <div class="mt-3 text-center">
                <%= f.button({
                  class: "btn btn-primary",
                  type: :submit,
                  data: { disable_with: t("messages.connected_accounts.connecting") }
                }) do %>
                  <%= t("verbs.connect") %>
                <% end %>
              </div>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
